<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, width=device-width">
  <link rel="stylesheet" href="./lastpage.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@300;400;500&display=swap" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500&display=swap" />
  <style>
    .explanation-box {
      margin: 24px auto;
      padding: 16px;
      background-color: #f2f5ff;
      border-left: 4px solid #0367fd;
      width: 80%;
      font-family: 'Lexend Deca', sans-serif;
      font-size: 14px;
      line-height: 1.6;
      color: #333;
    }
  </style>
</head>
<body>

  <div class="macbook-pro-14-12">
    <div class="frame-parent">
        
      <div class="your-list-of-stocks-parent">
        <div class="your-list-of">Your List of Stocks</div>
       </div>
      <div class="instance-parent">
        <!-- Repeating block structure -->
        <!-- 8 total cards -->
        <!-- Start Loop -->
        <!-- CARD 1 -->
        <div class="frame-wrapper">
          <div class="frame-group">
            <img class="frame-child" alt="" src="images/Frame 30.png">
            <div class="hdfc-bank-parent">
              <div class="hdfc-bank">&nbsp;</div> <!-- Symbol -->
              <div class="frame-container">
                <div class="medium-wrapper">
                  <div class="medium">&nbsp;</div> <!-- Open Price -->
                </div>
                <div class="medium-wrapper">
                  <div class="medium">&nbsp;</div> <!-- Close Price -->
                </div>
              </div>
            </div>
            <div class="wrapper">
              <div class="div">&nbsp;</div> <!-- Percentage Change -->
            </div>
          </div>
        </div>
    
        <!-- Repeat the same block 7 more times -->
    
        <!-- CARD 2 -->
        <div class="frame-wrapper">
          <div class="frame-group">
            <img class="frame-child" alt="" src="images/Frame 7.png">
            <div class="hdfc-bank-parent">
              <div class="hdfc-bank">&nbsp;</div>
              <div class="frame-container">
                <div class="medium-wrapper">
                  <div class="medium">&nbsp;</div>
                </div>
                <div class="medium-wrapper">
                  <div class="medium">&nbsp;</div>
                </div>
              </div>
            </div>
            <div class="wrapper">
              <div class="div">&nbsp;</div>
            </div>
          </div>
        </div>
    
        <!-- CARD 3 -->
        <div class="frame-wrapper">
          <div class="frame-group">
            <img class="frame-child" alt="" src="images/Frame 4.png">
            <div class="hdfc-bank-parent">
              <div class="hdfc-bank">&nbsp;</div>
              <div class="frame-container">
                <div class="medium-wrapper">
                  <div class="medium">&nbsp;</div>
                </div>
                <div class="medium-wrapper">
                  <div class="medium">&nbsp;</div>
                </div>
              </div>
            </div>
            <div class="wrapper">
              <div class="div">&nbsp;</div>
            </div>
          </div>
        </div>
    
        <!-- CARD 4 -->
        <div class="frame-wrapper">
          <div class="frame-group">
            <img class="frame-child" alt="" src="images/Frame 8.png">
            <div class="hdfc-bank-parent">
              <div class="hdfc-bank">&nbsp;</div>
              <div class="frame-container">
                <div class="medium-wrapper">
                  <div class="medium">&nbsp;</div>
                </div>
                <div class="medium-wrapper">
                  <div class="medium">&nbsp;</div>
                </div>
              </div>
            </div>
            <div class="wrapper">
              <div class="div">&nbsp;</div>
            </div>
          </div>
        </div>
    
        <!-- CARD 5 -->
        <div class="frame-wrapper">
          <div class="frame-group">
            <img class="frame-child" alt="" src="images/Frame 9.png">
            <div class="hdfc-bank-parent">
              <div class="hdfc-bank">&nbsp;</div>
              <div class="frame-container">
                <div class="medium-wrapper">
                  <div class="medium">&nbsp;</div>
                </div>
                <div class="medium-wrapper">
                  <div class="medium">&nbsp;</div>
                </div>
              </div>
            </div>
            <div class="wrapper">
              <div class="div">&nbsp;</div>
            </div>
          </div>
        </div>
    
      </div> <!-- end .instance-parent -->
    </div> <!-- end .frame-parent -->
  
           
  </div>
  <div class="stock-highlight">Stock Highlight</div>
  <div class="frame-parent15">
      <div class="frame-parent16">
          <img class="frame-child5" alt="" src="images/Frame 5.png">
          
          <div class="stock-highlight-parent">
              <div class="hdfc-bank">Stock Highlight</div>
              <div class="stock-highlight2">Stock Highlight</div>
          </div>
      </div>
      <div class="ellipse-parent">
          <div class="group-child">
          </div>
          <div class="group-item">
          </div>
          <div class="div8">75%</div>
      </div>
  </div>
  <div class="frame-parent17">
      <div class="frame-parent16">
          <img class="frame-child5" alt="" src="images/Frame 5.png">
          
          <div class="stock-highlight-parent">
              <div class="hdfc-bank">Stock Highlight</div>
              <div class="stock-highlight2">Stock Highlight</div>
          </div>
      </div>
      <div class="ellipse-parent">
          <div class="group-child">
          </div>
          <div class="group-item">
          </div>
          <div class="div8">75%</div>
      </div>
  </div>
  <div class="frame-parent19">
      <div class="frame-parent16">
          <img class="frame-child5" alt="" src="images/Frame 5.png">
          
          <div class="stock-highlight-parent">
              <div class="hdfc-bank">Stock Highlight</div>
              <div class="stock-highlight2">Stock Highlight</div>
          </div>
      </div>
      <div class="ellipse-parent">
          <div class="group-child">
          </div>
          <div class="group-item">
          </div>
          <div class="div8">75%</div>
      </div>
  </div>
  <div class="macbook-pro-14-12-child">
  </div>
  <div class="today-parent">
      <div class="today">Today</div>
      <div class="today">Week</div>
      <div class="today">Month</div>
      <div class="today">Year</div>
  </div>
  <div class="macbook-pro-14-12-item">
  </div>
  <img class="macbook-pro-14-12-inner" alt="" src="images/Frame 61.png">
  
  <div class="tools-wrapper">
      <div class="medium">Tools</div>
  </div>
  <div class="explore-wrapper">
      <div class="medium">Explore</div>
  </div>
  <div class="macbook-pro-14-12-inner1">
      <div class="frame-parent21">
          <div class="r-wrapper">
              <div class="medium">R</div>
          </div>
          <div class="rio-roy-parent">
              <div class="rio-roy">Rio Roy</div>
              <div class="profile">Profile</div>
          </div>
      </div>
  </div>
  <div class="macbook-pro-14-12-child1">
  </div>
</div>
    <!-- ALL YOUR EXISTING HTML LAYOUT GOES HERE -->
    <!-- ... (we’re omitting repeated divs for brevity) ... -->

    <!-- ✅ Script -->
    <script>
      async function submitRiskProfile() {
        const profile = {
          total_score: parseInt(localStorage.getItem('total_score') || "0")
        };
        console.log("Total score being sent:", profile.total_score);
    
        try {
          const response = await fetch("http://127.0.0.1:8000/recommend/", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(profile)
          });
    
          const data = await response.json();
          console.log("Backend response:", data);
    
          populateRecommendations(data.recommended_stocks, data.explanation);
        } catch (error) {
          console.error("Error fetching recommendations:", error);
        }
      }
    
      function populateRecommendations(stocks, explanation) {
        const boxes = document.querySelectorAll('.frame-wrapper');
    
        stocks.slice(0, 5).forEach((stock, i) => {
          const box = boxes[i];
          if (!box) return;
    
          // Symbol
          box.querySelector('.hdfc-bank').innerText = stock.symbol;
    
          // Percentage change
          const percentDiv = box.querySelector('.div');
          percentDiv.innerText = `${stock.percent_change >= 0 ? '+' : ''}${stock.percent_change.toFixed(2)}%`;
          percentDiv.style.color = stock.percent_change >= 0 ? 'green' : 'red';
    
          // Open and Close prices
          const mediums = box.querySelectorAll('.medium');
          if (mediums.length >= 2) {
            mediums[0].innerText = `Open: ₹${stock.open_price.toFixed(2)}`;
            mediums[1].innerText = `Close: ₹${stock.close_price.toFixed(2)}`;
          }
        });
    
        // ✅ GPT Explanation (only once)
        const explanationBox = document.createElement("div");
        explanationBox.className = "explanation-box";
        explanationBox.innerText = explanation;
        document.body.appendChild(explanationBox);
      }
    
      window.onload = submitRiskProfile;
    </script>
    
  </div>
</body>
</html>
